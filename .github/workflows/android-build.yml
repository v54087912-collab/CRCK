name: Universal Android Build on: workflow_dispatch: # Manual run using button push: branches: [ "main", "master" ] jobs: build: runs-on: ubuntu-latest steps: # 1. Checkout repository source code - name: Checkout Code uses: actions/checkout@v4 # 2. Setup Java JDK 17 (stable and recommended) - name: Set up JDK 17 uses: actions/setup-java@v4 with: java-version: '17' distribution: 'temurin' cache: gradle # 3. Detect project root automatically (find gradlew) - name: Detect Project Root id: detect_root run: | echo "Searching for gradlew..." GRADLEW_PATH=$(find . -name "gradlew" -type f | head -n 1) if [ -z "$GRADLEW_PATH" ]; then echo "Error: gradlew file not found!" exit 1 fi echo "Found gradlew at: $GRADLEW_PATH" PROJECT_ROOT=$(dirname "$GRADLEW_PATH") echo "PROJECT_ROOT=$PROJECT_ROOT" >> $GITHUB_ENV # 4. Setup Android SDK - name: Setup Android SDK uses: android-actions/setup-android@v3 # 5. Grant execute permission to gradlew - name: Grant Execute Permission run: chmod +x "$PROJECT_ROOT/gradlew" # 6. Build Debug APK (skip lint & tests) - name: Build Debug APK run: | cd "$PROJECT_ROOT" ./gradlew assembleDebug -x lint -x test --stacktrace # 7. Upload APK (find APK anywhere in repo) - name: Upload APK uses: actions/upload-artifact@v4 with: name: Universal-Built-APK path: '**/*.apk'
